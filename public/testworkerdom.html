<!DOCTYPE html>
<head>

    
    <script crossorigin src="https://unpkg.com/react@16/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@16/umd/react-dom.development.js"></script>
    
</head>
<body>
    <script type="module" async>

        const worker = new Worker("workercomponent.js");
        // const shaWorker = new Worker("sha256.worker.js");

        // shaWorker.postMessage("Hello World")
        // shaWorker.onmessage = (m)=> console.log(m)

        // worker.postMessage("World")





        let el = null;
        let reactEl = null
        
        const hydrate = ()=>{
            ReactDOM.hydrate( reactEl, el)
        }
        
        worker.onmessage = (d)=> {
            if (d.data.domString){

                el = document.createElement("div");
                el.innerHTML = d.data.domString;

                document.body.appendChild(el);
                if (reactEl) hydrate()
            }
            if (d.data.code) {
                const {code, pastEvents} = d.data
                const Counter = new Function("props", `return (${code})(props)`)
                
                reactEl = React.createElement(Counter,  {pastEvents});
                if (el) hydrate();
            }

 }

</script>
</body>