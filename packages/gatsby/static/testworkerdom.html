<!DOCTYPE html>
<html>
<head>
  <meta charset="utf8" />
  <script src="/clients-connection.js"></script>\
  <script src="/webtorrent.min.js"></script>
      
  <!-- <script crossorigin src="https://unpkg.com/react@16/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@16/umd/react-dom.development.js"></script>
     -->
</head>
<body>
  <video controls autoplay></video>
  <script async>

// new VideoStream(new file('sintel.mp4'), video)
     const client = new WebTorrent()

const magnet = "magnet:?xt=urn:btih:31cd99bb03101949c18970418220d13820193710&dn=VID_20170102_072807.mp4&tr=udp%3A%2F%2Ftracker.leechers-paradise.org%3A6969&tr=udp%3A%2F%2Ftracker.coppersurfer.tk%3A6969&tr=udp%3A%2F%2Ftracker.opentrackr.org%3A1337&tr=udp%3A%2F%2Fexplodie.org%3A6969&tr=udp%3A%2F%2Ftracker.empire-js.us%3A1337&tr=wss%3A%2F%2Ftracker.btorrent.xyz&tr=wss%3A%2F%2Ftracker.openwebtorrent.com"
client.add(magnet, function (torrent) {

  // Torrents can contain many files. Let's use the .mp4 file
  const file = torrent.files.find(function (file) {

    new VideoStream(files, document.querySelector('video'))
    
    return file.name.endsWith(".mp4")

  })})

  


  // Display the file by adding it to the DOM. Supports video, audio, image, etc. files
  // file.appendTo("body")



  // 

/*
const WebTorrent = require('webtorrent')

// This demo uses WebTorrent (https://webtorrent.io)
const client = new WebTorrent()

// Sintel torrent from webtorrent.io (https://webtorrent.io/torrents/sintel.torrent)
const torrentUrl = 'https://webtorrent.io/torrents/sintel.torrent'

client.add(torrentUrl, torrent => {
  // Got torrent metadata!
  console.log('Torrent info hash:', torrent.infoHash)
  // Let's say the fifth file is a mp4 (h264) video...
  new VideoStream(torrent.files[5], document.querySelector('video'))
})
*/


  // const video = document.querySelector("video")
  // const videoStream = new VideoStream(file, video)

  // video.addEventListener("error", () => {
  //   // listen for errors on the video/audio element directly
  //   const errorCode = elem.error
  //   const detailedError = videoStream.detailedError
  // })
// })
  </script>
  <script src="/testworker.js"></script>
</body>
</html>